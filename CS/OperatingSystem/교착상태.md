# 교착 상태 (Deadlock)

교착 상태는 멀티 프로그래밍 환경에서 두 개 이상의 프로세스가 서로가 가진 자원을 기다리며 다음 처리를 하지 못하는 상태이다.

<p align="center">
    <img src=https://user-images.githubusercontent.com/19389288/94839701-52540700-0452-11eb-9f3d-c814b942f1ad.jpg>
</p>

즉, 프로세스 A가 프로세스 B가 점유한 자원을 요청할 때 프로세스 B 또한 프로세스 A가 점유한 자원을 요청하는 것이다.

## 교착 상태가 발생하는 원인

### 1. 상호 배제 (Mutual Extension)
한 프로세스가 자원을 독점하고 있으며 다른 프로세스들은 접근이 불가능하다.

### 2. 점유 대기 (Hold And Wait)
최소한 하나의 자원을 점유하고 있으면서 다른 프로세스에 할당되어 사용하고 있는 자원을 추가로 점유하기 위해 대기하는 프로세스가 존재해야 한다.

### 3. 비선점 (No Preemption)
다른 프로세스에 할당된 자원은 사용이 끝날 때 까지 강제적으로 가져올 수 없다.

### 4. 순환 대기 (Circle Wait)
프로세스 A는 프로세스 B의 자원을 요구하고, 프로세스 B는 프로세스 A의 자원을 요구하는 등 서로의 자원을 요구하는 상황이다.

## 교착 상태를 해결하는 방법

### 1. 에방 (Prevention)

교착 상태 예방은 교착 상태의 발생조건 4가지 중 하나라도 발생하지 않게하여 교착 상태 발생 가능성을 차단하는 것이다.

발생 조건을 방지해서 데드락을 예방하는 방법은 **시스템의 처리량이나 효율성을 떨어트리는 단점**이 있다.

### 2. 회피 (Avoidance)

교착 상태 회피는 프로세스들이 요청하는 모든 자원을 교착 상태를 일으키지 않고 할당해줄 수 있는 상태인 Safe State에 있을 수 있도록 자원 할당을 허용하는 것이다. 이를 위해 은행원 알고리즘을 사용합니다.

#### 은행원 알고리즘 (Banker's Algorithm)

총 자원의 양과 현재 할당한 자원의 양을 기준으로 안정 또는 불안정 상태로 나누고 안정 상태로 가도록 자원을 할당하는 알고리즘

### 3. 탐지 및 회복 (Detection & Recovery)

교착 상태 탐지는 자원 할당 그래프를 통해 교착 상태가 발생하였는지 여부를 탐색한다.

교착 상태 회복은 탐지 기법을 사용해 발견한 교착 상태를 프로세스를 종료하거나, 할당된 자원을 해제하여 회복하는 것이다.

프로세스를 종료할 때는 교착 상태의 모든 프로세스를 종료하거나, 교착 상태가 회복될 때 까지 하나씩 종료하는 방법이 있다.

할당된 자원을 해제할 때는 교착 상태의 프로세스가 점유하고 있는 자원을 우선순위가 더 높은 프로세스에 할당하여 교착 상태를 회복한다.

